
@{
    ViewBag.Title = "Cart";
    Layout = "~/Views/Shared/_LayoutPage1.cshtml";
}
<link href="~/Content/style_K/Style_ThanhToan.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
<section id="cart" class="section-p1">

    <table width="100%">
        <thead>
            <tr>
                <td>Loại bỏ</td>
                <td>Hình ảnh</td>
                <td>Sản phẩm</td>
                <td>Giá bán</td>
                <td>Số lượng</td>
                <td>Tổng thu</td>
            </tr>
        </thead>



        <tbody id="cart-body">
            <!-- Dữ liệu sản phẩm sẽ được JS chèn vào đây -->

        </tbody>
        @*<tbody>
            <tr>
                <td><a href="#"><i class="bi bi-x-circle-fill"></i></a></td>
                <td><img src="https://cdn2.cellphones.com.vn/358x/media/catalog/product/i/p/iphone_17_256gb-3_2.jpg"
                   alt="iPhone 17 256GB" />
                </td>
                <td>IPhone 17</td>
                <td>34.999.000₫</td>
                <td><input type="number" value="1" /></td>
                <td>34.999.000₫</td>
            </tr>

            <tr>
                <td><a href="#"><i class="bi bi-x-circle-fill"></i></a></td>
                <td>
                    <img src="https://cdn2.cellphones.com.vn/insecure/rs:fill:358:358/q:90/plain/https://cellphones.com.vn/media/catalog/product/s/a/samsung-galaxy-a07-black.jpg"
                         alt="Samsung Galaxy A07 4GB 128GB" />
                </td>
                <td>Samsung Galaxy A07</td>
                <td>3.999.000₫</td>
                <td><input type="number" value="1" /></td>
                <td>3.999.000₫</td>
            </tr>

            <tr>
                <td><a href="#"><i class="bi bi-x-circle-fill"></i></a></td>
                <td>
                    <img src="https://cdn2.cellphones.com.vn/insecure/rs:fill:358:358/q:90/plain/https://cellphones.com.vn/media/catalog/product/d/i/dien-thoai-samsung-galaxy-a36.2.png"
                         alt="Samsung Galaxy A36 5G 8GB 128GB" />
                </td>
                <td>Samsung Galaxy A36</td>
                <td>7.499.000₫</td>
                <td><input type="number" value="1" /></td>
                <td>7.499.000₫</td>
            </tr>

        </tbody>*@
    </table>

</section>

<section id="cart-add" class="section-p1">
    <div id="sumtotal">
        <h2>Tổng giỏ hàng</h2>
        <table>
            <tr>
                <td>TỔNG THU</td>
                <td id="subtotal">0₫</td>

            </tr>

            <tr>
                <td>Phí vận chuyển</td>
                <td>Miễn phí</td>

            </tr>

            <tr>
                <td><strong>TỔNG</strong></td>
                <td><strong id="total">0₫</strong></td>

            </tr>
        </table>
        <button class="normal">Tiến hành kiểm tra</button>
    </div>

</section>

<script>
    const cartBody = document.getElementById('cart-body');
    const subtotalElem = document.getElementById('subtotal');
    const totalElem = document.getElementById('total');
    let cart = JSON.parse(localStorage.getItem('cart')) || [];

    function renderCart() {
        cartBody.innerHTML = ''; // Xóa nội dung cũ
        let total = 0;

        if (cart.length === 0) {
            cartBody.innerHTML = '<tr><td colspan="6">Giỏ hàng trống.</td></tr>';
        } else {
            cart.forEach((item, index) => {
                const price = parseFloat(item.price.replace(/[^\d]/g, ''));
                const quantity = item.quantity || 1;
                const sum = price * quantity;
                total += sum;

                cartBody.innerHTML += `
                    <tr>
                        <td><a href="#" onclick="removeItem(${index})"><i class="bi bi-x-circle-fill"></i></a></td>
                        <td><img src="${item.image}" width="80" /></td>
                        <td>${item.name}</td>
                        <td>${item.price}</td>
                        <td><input type="number" min="1" value="${quantity}" onchange="updateQuantity(${index}, this.value)" /></td>
                        <td>${sum.toLocaleString('vi-VN')}₫</td>
                    </tr>
                `;
            });
        }

        subtotalElem.innerText = total.toLocaleString('vi-VN') + '₫';
        totalElem.innerText = total.toLocaleString('vi-VN') + '₫';
    }

    // Cập nhật số lượng
    function updateQuantity(index, newQuantity) {
        cart[index].quantity = parseInt(newQuantity);
        localStorage.setItem('cart', JSON.stringify(cart));
        renderCart();
    }

    // Xóa sản phẩm
    function removeItem(index) {
        if (confirm('Bạn có chắc muốn xóa sản phẩm này không?')) {
            cart.splice(index, 1);
            localStorage.setItem('cart', JSON.stringify(cart));
            renderCart();
        }
    }

    renderCart(); // Gọi khi trang tải xong
</script>

<div class="card">
    <div>
        <div class="bank-info">
            <p><strong>Số tài khoản:</strong> 4556 6888 89</p>
            <p><strong>Ngân hàng:</strong>Techcombank </p>
            <p><strong>Chủ tài khoản: </strong>QUA MÔN</p>
        </div>


        <div class="qr-section">
            <img style="width:250px;height:250px"
                 src="~/Content/img/qr.jpg" />

            <p class="qr-instruction">Dùng ứng dụng ngân hàng quét mã QR để chuyển khoản</p>
        </div>

        <div class="divider"></div>


        <div class="payment-info">
            <h2>Thông tin thanh toán</h2>
            <p>Quý khách vui lòng lựa chọn các hình thức thanh toán dưới đây:</p>
            <div class="options">
                <div class="option">
                    <input type="radio" id="kredivo" name="payment_method">
                    <label for="kredivo">Thanh toán Kredivo</label>
                </div>
                <div class="option">
                    <input type="radio" id="onepay" name="payment_method" checked>
                    <label for="onepay">Thanh toán OnePay</label>
                </div>
            </div>
            <a href="#" class="other-methods">Các hình thức thanh toán khác </a>
        </div>
    </div>


    <div class="footer">
        <p>Khi cần hỗ trợ vui lòng gọi <a href="tel:19006626">1900.6626</a> (08:00 - 22:00)</p>
        <a href="#">Xem chính sách mua hàng</a>
        <a href="/Default/Index" class="home-btn">Về trang chủ</a>
    </div>
</div>
